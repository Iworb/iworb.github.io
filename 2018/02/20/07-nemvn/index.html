<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <meta name="description" content="Just another one developer blog, who looked for Holy grail">
  <meta name="keyword" content="hexo-theme, vuejs">
  
    <link rel="shortcut icon" href="/css/images/logo.png">
  
  <title>
    
      Full Stack (Node + Express + MongoDb + Vue + Nuxt) application. Part 7: Visual part | Iworb&#39;s blog
    
  </title>
  <link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="//cdn.bootcss.com/nprogress/0.2.0/nprogress.min.css" rel="stylesheet">
  <link href="//cdn.bootcss.com/highlight.js/9.12.0/styles/tomorrow.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">
<link rel="stylesheet" href="/css/plugins/gitment.css">
  <script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
  <script src="//cdn.bootcss.com/geopattern/1.2.3/js/geopattern.min.js"></script>
  <script src="//cdn.bootcss.com/nprogress/0.2.0/nprogress.min.js"></script>
  <script src="/js/qrious.js"></script>
<script src="/js/gitment.js"></script>
  
  
    <!-- MathJax support START -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <!-- MathJax support END -->
  


</head>
<div class="wechat-share">
  <img src="/css/images/logo.png" />
</div>

  <body>
    <header class="header fixed-header">
  <div class="header-container">
    <a class="home-link" href="/">
      <div class="logo"></div>
      <span>Iworb's blog</span>
    </a>
    <ul class="right-list">
      
        <li class="list-item">
          
            <a href="/" class="item-link">Home</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/tags/" class="item-link">Tags</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/archives/" class="item-link">Archive</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/about/" class="item-link">About me</a>
          
        </li>
      
    </ul>
    <div class="menu">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </div>
    <div class="menu-mask">
      <ul class="menu-list">
        
          <li class="menu-item">
            
              <a href="/" class="menu-link">Home</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/tags/" class="menu-link">Tags</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/archives/" class="menu-link">Archive</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/about/" class="menu-link">About me</a>
            
          </li>
        
      </ul>
    </div>
  </div>
</header>

    <div id="article-banner">
  <h2>Full Stack (Node + Express + MongoDb + Vue + Nuxt) application. Part 7: Visual part</h2>
  <p class="post-date">2018-02-20</p>
  <div class="arrow-down">
    <a href="javascript:;"></a>
  </div>
</div>
<main class="app-body flex-box">
  <!-- Article START -->
  <article class="post-article">
    <section class="markdown-content"><p>In the frontend we should save our user in the store. Let’s make new one <code>client/store/auth.js</code>:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> state = <span class="function"><span class="params">()</span> =&gt;</span> (&#123;</span><br><span class="line">  user: <span class="literal">null</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> mutations = &#123;</span><br><span class="line">  SET_USER: <span class="function">(<span class="params">state, user</span>) =&gt;</span> &#123;</span><br><span class="line">    state.user = user</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> actions = &#123;</span><br><span class="line">  <span class="keyword">async</span> login (&#123;commit&#125;, &#123;username, password&#125;) &#123;</span><br><span class="line">    <span class="keyword">const</span> data = <span class="keyword">await</span> <span class="keyword">this</span>.$axios.$post(<span class="string">'/login'</span>, &#123;username, password&#125;)</span><br><span class="line">    commit(<span class="string">'SET_USER'</span>, data)</span><br><span class="line">    <span class="keyword">this</span>.$router.push(&#123;<span class="attr">path</span>: <span class="string">'/'</span>&#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="keyword">async</span> logout (&#123;commit&#125;) &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="keyword">this</span>.$axios.post(<span class="string">'/logout'</span>)</span><br><span class="line">    commit(<span class="string">'SET_USER'</span>, <span class="literal">null</span>)</span><br><span class="line">    <span class="keyword">this</span>.$router.push(&#123;<span class="attr">path</span>: <span class="string">'/login'</span>&#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Each store (Vuex) have it’s own state, mutations and actions. Mutations are sync and actions could be async. For more details read Vuex documentation.<br>We have some new dependencies:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add axios @nuxtjs/axios</span><br></pre></td></tr></table></figure></p>
<p>Axios is package for requests.<br>Good thing abour Nuxt is SSR. You could set user on the server side if there’s user in request. Unfortunately, this action could be performed only in the <code>client/store/index.js</code> point, so let’s make it:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> actions = &#123;</span><br><span class="line">  nuxtServerInit (&#123;commit&#125;, &#123;req&#125;) &#123;</span><br><span class="line">    <span class="keyword">if</span> (req.user) commit(<span class="string">'auth/SET_USER'</span>, req.user)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>NB: commit to <code>auth</code> storage and call <code>SET_USER</code> mutation.<br>Now let’s change <code>index.vue</code> page:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">        &lt;h1&gt;Please login to see the secret content&lt;/h1&gt;</span><br><span class="line">        &lt;form v-if=&quot;!$store.state.auth.user&quot; @submit.prevent=&quot;login&quot;&gt;</span><br><span class="line">            &lt;p class=&quot;error&quot; v-if=&quot;formError&quot;&gt;&#123;&#123; formError &#125;&#125;&lt;/p&gt;</span><br><span class="line">            &lt;p&gt;&lt;i&gt;To login, use &lt;b&gt;camin&lt;/b&gt; as username and &lt;b&gt;qwe123&lt;/b&gt; as password.&lt;/i&gt;&lt;/p&gt;</span><br><span class="line">            &lt;p&gt;Username: &lt;input type=&quot;text&quot; v-model=&quot;formUsername&quot; name=&quot;username&quot; /&gt;&lt;/p&gt;</span><br><span class="line">            &lt;p&gt;Password: &lt;input type=&quot;password&quot; v-model=&quot;formPassword&quot; name=&quot;password&quot; /&gt;&lt;/p&gt;</span><br><span class="line">            &lt;button type=&quot;submit&quot;&gt;Login&lt;/button&gt;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line">        &lt;div v-else&gt;</span><br><span class="line">            Hello &#123;&#123; $store.state.auth.user.name &#125;&#125;!</span><br><span class="line">            &lt;pre&gt;I am the secret content, I am shown only when the use is connected.&lt;/pre&gt;</span><br><span class="line">            &lt;p&gt;&lt;i&gt;You can also refresh this page, you&apos;ll still be connected!&lt;/i&gt;&lt;/p&gt;</span><br><span class="line">            &lt;button @click=&quot;logout&quot;&gt;Logout&lt;/button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    export default &#123;</span><br><span class="line">      data () &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">          formError: null,</span><br><span class="line">          formUsername: &apos;&apos;,</span><br><span class="line">          formPassword: &apos;&apos;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;</span><br><span class="line">        async login() &#123;</span><br><span class="line">          try &#123;</span><br><span class="line">            await this.$store.dispatch(&apos;auth/login&apos;, &#123;</span><br><span class="line">              username: this.formUsername,</span><br><span class="line">              password: this.formPassword</span><br><span class="line">            &#125;)</span><br><span class="line">            this.formUsername = &apos;&apos;</span><br><span class="line">            this.formPassword = &apos;&apos;</span><br><span class="line">            this.formError = null</span><br><span class="line">          &#125; catch (e) &#123;</span><br><span class="line">            this.formError = e.message</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        async logout() &#123;</span><br><span class="line">          try &#123;</span><br><span class="line">            await this.$store.dispatch(&apos;auth/logout&apos;)</span><br><span class="line">          &#125; catch (e) &#123;</span><br><span class="line">            this.formError = e.message</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;stylus&quot;&gt;</span><br><span class="line">    .container</span><br><span class="line">        padding 100px</span><br><span class="line">    .error</span><br><span class="line">        color red</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure></p>
<p>Now we can login and stayed login until logout.</p>
<h2 id="Visual-framework-Vuetify"><a href="#Visual-framework-Vuetify" class="headerlink" title="Visual framework: Vuetify"></a>Visual framework: Vuetify</h2><p>There’s two popular frameworks for material design: <a href="Vuetifyjs.com">Vuetify</a> and <a href="http://quasar-framework.org" target="_blank" rel="noopener">Quasar</a>.<br>Personally I prefer Quasar, because he has more use cases. But it does not support SSR currently (v0.15.0-beta.13), so I have to use Vuetify:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add vuetify roboto-fontface nuxt-material-design-icons</span><br></pre></td></tr></table></figure></p>
<p>NB: <code>nuxt-material-design-icons</code> takes really long time to install, so be patient.<br>Let’s extend our <code>nuxt.config.js</code> to include all things:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  loading: &#123;<span class="attr">color</span>: <span class="string">'#3B8070'</span>&#125;,</span><br><span class="line">  srcDir: <span class="string">'client/'</span>,</span><br><span class="line">  <span class="comment">// [1]</span></span><br><span class="line">  build: &#123;</span><br><span class="line">    vendor: [</span><br><span class="line">      <span class="string">'vuetify'</span>,</span><br><span class="line">      <span class="string">'axios'</span>,</span><br><span class="line">      <span class="string">'roboto-fontface'</span></span><br><span class="line">    ],</span><br><span class="line">    extractCss: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// [2]</span></span><br><span class="line">  modules: [</span><br><span class="line">    <span class="string">'@nuxtjs/axios'</span>,</span><br><span class="line">    <span class="string">'nuxt-material-design-icons'</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// [3]</span></span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="string">'~/plugins/axios'</span>,</span><br><span class="line">    <span class="string">'~plugins/vuetify.js'</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// [4]</span></span><br><span class="line">  css: [</span><br><span class="line">    <span class="string">`~assets/style/app.styl`</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// [5]</span></span><br><span class="line">  router: &#123;</span><br><span class="line">    middleware: <span class="string">'auth'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Nuxt can build single vendor package [1]. It’s good way to pack frequently using libraries, so let’s include <code>vuetify</code>, <code>axios</code> and <code>roboto-fontface</code> into vendor build.<br>Next thing is modules [2] which extends default Nuxt functionality.<br>Plugins [3] are our custom plugins for <code>Vuetify</code> and some error handling for <code>axios</code>.<br>Custom css [4] lands in <code>css</code> property.<br>To restrict our routes to authenticated users we could set middleware [5].<br>Plugins, css and middlewares are things that should be written by yourself, because they’re extend Nuxt functionality for your own purposes.<br>Let’s take a look at plugins.<br><code>client/plugins/axios.js</code> - redirect to the <code>login</code> page if you not authorized anymore:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> (<span class="params">&#123;$axios, redirect&#125;</span>) </span>&#123;</span><br><span class="line">  $axios.onError(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> code = <span class="built_in">parseInt</span>(error.response &amp;&amp; error.response.status)</span><br><span class="line">    <span class="keyword">if</span> (code === <span class="number">401</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> redirect(<span class="string">'/login'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>client/plugins/vuetify.js</code> - include <code>Vuetify</code> with custom colors:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> Vuetify <span class="keyword">from</span> <span class="string">'vuetify'</span></span><br><span class="line"><span class="keyword">import</span> colors <span class="keyword">from</span> <span class="string">'vuetify/es5/util/colors'</span></span><br><span class="line"></span><br><span class="line">Vue.use(Vuetify, &#123;</span><br><span class="line">  theme:</span><br><span class="line">    &#123;</span><br><span class="line">      primary: colors.purple.base,</span><br><span class="line">      secondary: colors.grey.lighten1,</span><br><span class="line">      accent: colors.purple.lighten3,</span><br><span class="line">      error: colors.red.darken4,</span><br><span class="line">      warning: colors.amber.darken1,</span><br><span class="line">      info: colors.blue.darken4,</span><br><span class="line">      success: colors.green.darken3</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>Our css file is simple atm. <code>client/assets/style/app.styl</code>:<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@require <span class="string">'~vuetify/src/stylus/main.styl'</span></span><br><span class="line"></span><br><span class="line">.page</span><br><span class="line">  @extend .fade-<span class="attribute">transition</span></span><br></pre></td></tr></table></figure></p>
<p>And last thing is middleware <code>client/middleware/auth.js</code>:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> (<span class="params">&#123;store, redirect&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!store.state.auth.user) &#123;</span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">'/login'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="Layouts-and-pages"><a href="#Layouts-and-pages" class="headerlink" title="Layouts and pages"></a>Layouts and pages</h2><p>Let’s split our login page and index one.<br>This pages should has different layout - clean for login and drawer based for other pages.<br>Clean layout is simple <code>client/layouts/clean.vue</code>:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;v-app&gt;</span><br><span class="line">        &lt;nuxt/&gt;</span><br><span class="line">    &lt;/v-app&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure></p>
<p>But <code>client/layouts/default.vue</code> is bit complicated:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;v-app&gt;</span><br><span class="line">        &lt;!-- [1] --&gt;</span><br><span class="line">        &lt;v-navigation-drawer</span><br><span class="line">                clipped</span><br><span class="line">                fixed</span><br><span class="line">                :value=&quot;$store.state.drawer&quot;</span><br><span class="line">                app</span><br><span class="line">        &gt;</span><br><span class="line">            &lt;v-list dense&gt;</span><br><span class="line">                &lt;v-list-tile router v-for=&quot;(item, i) in items&quot; :key=&quot;i&quot; :to=&quot;item.to&quot;&gt;</span><br><span class="line">                    &lt;v-list-tile-action&gt;</span><br><span class="line">                        &lt;v-icon v-html=&quot;item.icon&quot;&gt;&lt;/v-icon&gt;</span><br><span class="line">                    &lt;/v-list-tile-action&gt;</span><br><span class="line">                    &lt;v-list-tile-content&gt;</span><br><span class="line">                        &lt;v-list-tile-title v-text=&quot;item.title&quot;&gt;&lt;/v-list-tile-title&gt;</span><br><span class="line">                    &lt;/v-list-tile-content&gt;</span><br><span class="line">                &lt;/v-list-tile&gt;</span><br><span class="line">                &lt;v-list-tile @click.stop=&quot;logoutDialog = true&quot;&gt;</span><br><span class="line">                    &lt;v-list-tile-action&gt;</span><br><span class="line">                        &lt;v-icon&gt;all_out&lt;/v-icon&gt;</span><br><span class="line">                    &lt;/v-list-tile-action&gt;</span><br><span class="line">                    &lt;v-list-tile-content&gt;</span><br><span class="line">                        &lt;v-list-tile-title&gt;Sign Out&lt;/v-list-tile-title&gt;</span><br><span class="line">                    &lt;/v-list-tile-content&gt;</span><br><span class="line">                &lt;/v-list-tile&gt;</span><br><span class="line">            &lt;/v-list&gt;</span><br><span class="line">        &lt;/v-navigation-drawer&gt;</span><br><span class="line">        &lt;v-toolbar app fixed clipped-left color=&quot;primary&quot; dark&gt;</span><br><span class="line">            &lt;v-toolbar-side-icon @click.prevent=&quot;$store.commit(&apos;TOGGLE_DRAWER&apos;)&quot;/&gt;</span><br><span class="line">            &lt;v-toolbar-title&gt;Application&lt;/v-toolbar-title&gt;</span><br><span class="line">        &lt;/v-toolbar&gt;</span><br><span class="line">        &lt;v-content&gt;</span><br><span class="line">            &lt;v-container fluid fill-height&gt;</span><br><span class="line">                &lt;nuxt /&gt;</span><br><span class="line">            &lt;/v-container&gt;</span><br><span class="line">        &lt;/v-content&gt;</span><br><span class="line">        &lt;v-dialog</span><br><span class="line">                v-model=&quot;logoutDialog&quot;</span><br><span class="line">                max-width=&quot;500px&quot;</span><br><span class="line">        &gt;</span><br><span class="line">            &lt;v-card tile&gt;</span><br><span class="line">                &lt;v-toolbar card dark color=&quot;error&quot;&gt;</span><br><span class="line">                    &lt;v-toolbar-title&gt;Sign Out&lt;/v-toolbar-title&gt;</span><br><span class="line">                &lt;/v-toolbar&gt;</span><br><span class="line">                &lt;v-card-text&gt;</span><br><span class="line">                    Do you really want to logout?</span><br><span class="line">                &lt;/v-card-text&gt;</span><br><span class="line">                &lt;v-card-actions&gt;</span><br><span class="line">                    &lt;v-spacer&gt;&lt;/v-spacer&gt;</span><br><span class="line">                    &lt;v-btn color=&quot;primary&quot; flat @click.stop=&quot;logoutDialog = false&quot;&gt;No&lt;/v-btn&gt;</span><br><span class="line">                    &lt;v-btn color=&quot;error&quot; @click.stop=&quot;logout&quot;&gt;Yes&lt;/v-btn&gt;</span><br><span class="line">                &lt;/v-card-actions&gt;</span><br><span class="line">            &lt;/v-card&gt;</span><br><span class="line">        &lt;/v-dialog&gt;</span><br><span class="line">    &lt;/v-app&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    data() &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        logoutDialog: false,</span><br><span class="line">        items: [</span><br><span class="line">          &#123; icon: &quot;home&quot;, title: &quot;Home&quot;, to: &quot;/&quot; &#125;,</span><br><span class="line">          &#123; icon: &quot;face&quot;, title: &quot;Demo&quot;, to: &quot;/demo&quot; &#125;,</span><br><span class="line">          &#123; icon: &quot;view_list&quot;, title: &quot;Posts&quot;, to: &quot;/posts&quot; &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">      async logout () &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">          await this.$store.dispatch(&apos;auth/logout&apos;)</span><br><span class="line">        &#125; catch (e) &#123;</span><br><span class="line">          console.log(e.message)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<p>There’s some new things to know.<br>Drawer visibility property [1] is moved to an index store and toggle with mutation <code>client/store/index.js</code>:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> state = <span class="function"><span class="params">()</span> =&gt;</span> (&#123;</span><br><span class="line">  drawer: <span class="literal">true</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> mutations = &#123;</span><br><span class="line">  TOGGLE_DRAWER (state) &#123;</span><br><span class="line">    state.drawer = !state.drawer</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> actions = &#123;</span><br><span class="line">  nuxtServerInit (&#123;commit&#125;, &#123;req&#125;) &#123;</span><br><span class="line">    <span class="keyword">if</span> (req.user) commit(<span class="string">'auth/SET_USER'</span>, req.user)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Now let’s make <code>client/pages/login,vue</code> page:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;v-content&gt;</span><br><span class="line">        &lt;v-container fluid fill-height&gt;</span><br><span class="line">            &lt;v-layout align-center justify-center&gt;</span><br><span class="line">                &lt;v-flex xs12 sm8 md4&gt;</span><br><span class="line">                    &lt;v-form @submit.prevent=&quot;login&quot;&gt;</span><br><span class="line">                        &lt;v-card class=&quot;elevation-12&quot;&gt;</span><br><span class="line">                            &lt;v-toolbar dark color=&quot;primary&quot;&gt;</span><br><span class="line">                                &lt;v-toolbar-title&gt;Sign In&lt;/v-toolbar-title&gt;</span><br><span class="line">                            &lt;/v-toolbar&gt;</span><br><span class="line">                            &lt;v-card-text&gt;</span><br><span class="line"></span><br><span class="line">                                &lt;v-text-field</span><br><span class="line">                                        prepend-icon=&quot;person&quot;</span><br><span class="line">                                        v-model=&quot;form.login.values.username&quot;</span><br><span class="line">                                        label=&quot;Username&quot;</span><br><span class="line">                                        type=&quot;text&quot;</span><br><span class="line">                                        :error-messages=&quot;form.login.errors.username&quot;</span><br><span class="line">                                &gt;&lt;/v-text-field&gt;</span><br><span class="line">                                &lt;v-text-field</span><br><span class="line">                                        prepend-icon=&quot;lock&quot;</span><br><span class="line">                                        v-model=&quot;form.login.values.password&quot;</span><br><span class="line">                                        label=&quot;Password&quot;</span><br><span class="line">                                        :append-icon=&quot;e1 ? &apos;visibility&apos; : &apos;visibility_off&apos;&quot;</span><br><span class="line">                                        :append-icon-cb=&quot;() =&gt; (e1 = !e1)&quot;</span><br><span class="line">                                        :type=&quot;e1 ? &apos;password&apos; : &apos;text&apos;&quot;</span><br><span class="line">                                        :error-messages=&quot;form.login.errors.password&quot;</span><br><span class="line">                                &gt;&lt;/v-text-field&gt;</span><br><span class="line"></span><br><span class="line">                            &lt;/v-card-text&gt;</span><br><span class="line">                            &lt;v-card-actions&gt;</span><br><span class="line">                                &lt;v-spacer&gt;&lt;/v-spacer&gt;</span><br><span class="line">                                &lt;v-btn color=&quot;primary&quot; type=&quot;submit&quot;&gt;Sign In&lt;/v-btn&gt;</span><br><span class="line">                            &lt;/v-card-actions&gt;</span><br><span class="line">                        &lt;/v-card&gt;</span><br><span class="line">                    &lt;/v-form&gt;</span><br><span class="line">                &lt;/v-flex&gt;</span><br><span class="line">            &lt;/v-layout&gt;</span><br><span class="line">        &lt;/v-container&gt;</span><br><span class="line">    &lt;/v-content&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  // [1]</span><br><span class="line">  import &#123;resetFormErrors, catchFormErrors&#125; from &apos;../mixins&apos;</span><br><span class="line"></span><br><span class="line">  export default &#123;</span><br><span class="line">    // [2]</span><br><span class="line">    layout: &apos;clean&apos;,</span><br><span class="line">    middleware: [],</span><br><span class="line">    mixins: [resetFormErrors, catchFormErrors],</span><br><span class="line">    data () &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        e1: true,</span><br><span class="line">        form: &#123;</span><br><span class="line">          login: &#123;</span><br><span class="line">            values: &#123;</span><br><span class="line">              username: &apos;&apos;,</span><br><span class="line">              password: &apos;&apos;</span><br><span class="line">            &#125;,</span><br><span class="line">            errors: &#123;</span><br><span class="line">              username: [],</span><br><span class="line">              password: []</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">      async login () &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">          this.resetFormErrors(this.form.login)</span><br><span class="line">          await this.$store.dispatch(&apos;auth/login&apos;, this.form.login.values)</span><br><span class="line">        &#125; catch (e) &#123;</span><br><span class="line">          this.catchFormErrors(this.form.login, e)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<p>We should define our <code>layout</code> [2] if it’s not <code>default</code>.<br>There’s some mixins [1] I made for better error catching for forms. Why mixins? Because forms are using a lot in each application, different pages should handle form validation.<br>So I decided to make 2 mixins for reset form errors and passing errors to form.<br><code>client/mixins/resetFormErrors.js</code>:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  methods: &#123;</span><br><span class="line">    resetFormErrors (form) &#123;</span><br><span class="line">      <span class="keyword">if</span> (form &amp;&amp; form.errors) &#123;</span><br><span class="line">        <span class="built_in">Object</span>.keys(form.errors).forEach(<span class="function"><span class="params">k</span> =&gt;</span> &#123;</span><br><span class="line">          form.errors[k] = []</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>client/mixins/catchFormErrors.js</code> (we’re passing our form errors as <code>fields</code> variable inside error in the server side):<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  methods: &#123;</span><br><span class="line">    catchFormErrors (form, err) &#123;</span><br><span class="line">      <span class="keyword">if</span> (form &amp;&amp; form.errors &amp;&amp; err.response &amp;&amp; err.response.data &amp;&amp; err.response.data.error &amp;&amp; err.response.data.error.fields) &#123;</span><br><span class="line">        <span class="keyword">const</span> fields = err.response.data.error.fields</span><br><span class="line">        <span class="built_in">Object</span>.keys(fields).forEach(<span class="function"><span class="params">k</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (form.errors.hasOwnProperty(k) &amp;&amp; <span class="keyword">typeof</span> form.errors[k] === <span class="string">'object'</span>) &#123;</span><br><span class="line">            form.errors[k].push(fields[k])</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>And <code>index.js</code> file to gather mixins:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> catchFormErrors <span class="keyword">from</span> <span class="string">'./catchFormErrors'</span></span><br><span class="line"><span class="keyword">import</span> resetFormErrors <span class="keyword">from</span> <span class="string">'./resetFormErrors'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123;</span><br><span class="line">  catchFormErrors,</span><br><span class="line">  resetFormErrors</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Now we can clean <code>index.vue</code> page:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            Hello &#123;&#123; $store.state.auth.user.name &#125;&#125;!</span><br><span class="line">            &lt;pre&gt;I am the secret content, I am shown only when the user is connected.&lt;/pre&gt;</span><br><span class="line">            &lt;p&gt;&lt;i&gt;You can also refresh this page, you&apos;ll still be connected!&lt;/i&gt;&lt;/p&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi feugiat diam et semper commodo. Praesent et lobortis nisi. Nulla laoreet urna sed sem fringilla, non consectetur dui feugiat. Proin elit eros, sagittis sit amet condimentum id, consectetur id diam. Integer sed nunc vitae nulla rutrum malesuada. Nunc aliquet augue eget mattis aliquam. Praesent eleifend varius orci rutrum auctor. Phasellus neque ipsum, euismod nec massa eget, aliquam porta ex.</span><br><span class="line"></span><br><span class="line">            Vivamus dapibus enim in suscipit porta. Vivamus ac pulvinar nisl. Proin id arcu ut leo pellentesque facilisis at lobortis sapien. In rutrum varius massa, sed egestas enim volutpat in. Nunc pharetra sagittis dui, id bibendum dolor congue et. Nam iaculis, felis in pretium sagittis, massa est lobortis leo, vel tincidunt tellus sem eu arcu. Mauris ultricies suscipit congue. Sed quis lobortis enim. Cras in tellus eu erat auctor vehicula. Nam urna nisi, tristique vel fringilla vitae, fringilla quis ligula. Fusce dictum ipsum ut ornare euismod. Fusce pulvinar justo nec neque laoreet scelerisque.</span><br><span class="line"></span><br><span class="line">            Aenean lorem neque, sollicitudin at ex ut, ullamcorper condimentum diam. Fusce enim quam, ultricies nec magna ut, porttitor commodo nibh. Curabitur vitae suscipit elit. Vestibulum sit amet libero lobortis, accumsan dolor congue, iaculis neque. Nunc sodales sollicitudin augue quis porta. Vestibulum lacus quam, elementum id euismod vitae, sollicitudin at massa. Maecenas eget ultrices tellus. Nullam eu placerat quam.</span><br><span class="line"></span><br><span class="line">            Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Nulla porttitor dui id neque vehicula, ut suscipit metus laoreet. Orci varius natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Ut fermentum enim nec egestas accumsan. Nulla sit amet orci sit amet justo egestas efficitur. Praesent vel libero metus. Mauris quam sapien, condimentum non varius eget, tincidunt et lectus.</span><br><span class="line"></span><br><span class="line">            Nunc porttitor pretium purus ut maximus. Curabitur viverra imperdiet sapien, eget tincidunt ligula tincidunt volutpat. Vivamus faucibus laoreet diam non pellentesque. Cras egestas dui at rutrum maximus. Sed vehicula lectus a lorem convallis, eget varius nulla dignissim. Interdum et malesuada fames ac ante ipsum primis in faucibus. Nam vel sapien non augue finibus scelerisque ut ac nibh. Sed non facilisis quam.</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure></p>
<p>NB: there’s no <code>Demo</code> and <code>Posts</code> pages atm. Menu items defined for future purposes and doen’t works.<br>This part wraps up <code>07-visual</code> git branch.</p>
</section>
    <!-- Tags START -->
    
      <div class="tags">
        <span>Tags:</span>
        
  <a href="/tags#nuxt" >
    <span class="tag-code">nuxt</span>
  </a>

  <a href="/tags#vuetify" >
    <span class="tag-code">vuetify</span>
  </a>

      </div>
    
    <!-- Tags END -->
    <!-- NAV START -->
    
  <div class="nav-container">
    <!-- reverse left and right to put prev and next in a more logic postition -->
    
      <a class="nav-left" href="/2018/02/15/06-nemvn/">
        <span class="nav-arrow">← </span>
        
          Full Stack (Node + Express + MongoDb + Vue + Nuxt) application. Part 6: Authentication
        
      </a>
    
    
  </div>

    <!-- NAV END -->
    <!-- 打赏 START -->
    
    <!-- 打赏 END -->
    <!-- 二维码 START -->
    
    <!-- 二维码 END -->
    
      <!-- Gitment START -->
      <div id="comments"></div>
      <!-- Gitment END -->
    
  </article>
  <!-- Article END -->
  <!-- Catalog START -->
  
    <aside class="catalog-container">
  <div class="toc-main">
    <strong class="toc-title">Catalog</strong>
    
      <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#Visual-framework-Vuetify"><span class="toc-nav-text">Visual framework: Vuetify</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#Layouts-and-pages"><span class="toc-nav-text">Layouts and pages</span></a></li></ol>
    
  </div>
</aside>
  
  <!-- Catalog END -->
</main>

<script>
  (function () {
    var url = 'http://iworb.github.io/2018/02/20/07-nemvn/';
    var banner = ''
    if (banner !== '' && banner !== 'undefined' && banner !== 'null') {
      $('#article-banner').css({
        'background-image': 'url(' + banner + ')'
      })
    } else {
      $('#article-banner').geopattern(url)
    }
    $('.header').removeClass('fixed-header')

     // error image
    $(".markdown-content img").on('error', function() {
      $(this).attr('src', 'http://file.muyutech.com/error-img.png')
      $(this).css({
        'cursor': 'default'
      })
    })

    // zoom image
    $(".markdown-content img").on('click', function() {
      var src = $(this).attr('src')
      if (src !== 'http://file.muyutech.com/error-img.png') {
        var imageW = $(this).width()
        var imageH = $(this).height()
        
        var zoom = ($(window).width() * 0.95 / imageW).toFixed(2)
        zoom = zoom < 1 ? 1 : zoom
        zoom = zoom > 2 ? 2 : zoom
        var transY = (($(window).height() - imageH) / 2).toFixed(2)

        $('body').append('<div class="image-view-wrap"><div class="image-view-inner"><img src="'+ src +'" /></div></div>')
        $('.image-view-wrap').addClass('wrap-active')
        $('.image-view-wrap img').css({
          'width': `${imageW}`,
          'transform': `translate3d(0, ${transY}px, 0) scale3d(${zoom}, ${zoom}, 1)`
        })
        $('html').css('overflow', 'hidden')

        $('.image-view-wrap').on('click', function() {
          $(this).remove()
          $('html').attr('style', '')
        })
      }
    })

    // qrcode
    var qr = new QRious({
      element: document.getElementById('share-qrcode'),
      value: document.location.href
    });

    // gitment
    var gitmentConfig = "iworb";
    if (gitmentConfig !== 'undefined') {
      var gitment = new Gitment({
        id: "Full Stack (Node + Express + MongoDb + Vue + Nuxt) application. Part 7: Visual part",
        owner: "iworb",
        repo: "iworb.github.io",
        oauth: {
          client_id: "fc37e05eb55faa187774",
          client_secret: "5f04db8e93239c8bded02d72e698c87a985f428c"
        },
        theme: {
          render(state, instance) {
            const container = document.createElement('div')
            container.lang = "ru-RU"
            container.className = 'gitment-container gitment-root-container'
            container.appendChild(instance.renderHeader(state, instance))
            container.appendChild(instance.renderEditor(state, instance))
            container.appendChild(instance.renderComments(state, instance))
            container.appendChild(instance.renderFooter(state, instance))
            return container;
          }
        }
      })
      gitment.render(document.getElementById('comments'))
    }
  })();
</script>

    <div class="scroll-top">
  <span class="arrow-icon"></span>
</div>
    <footer class="app-footer">
  <p class="copyright">
    &copy; 2018 | Proudly powered by <a href="https://hexo.io" target="_blank">Hexo</a>
    <br>
    Theme by <a href="https://github.com/yanm1ng">yanm1ng</a>
  </p>
</footer>

<script>
  function async(u, c) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }
</script>
<script>
  async("//cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
    FastClick.attach(document.body);
  })
</script>

<script>
  var hasLine = 'true';
  async("//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js", function(){
    $('figure pre').each(function(i, block) {
      var figure = $(this).parents('figure');
      if (hasLine === 'false') {
        figure.find('.gutter').hide();
      }
      var lang = figure.attr('class').split(' ')[1] || 'code';
      var codeHtml = $(this).html();
      var codeTag = document.createElement('code');
      codeTag.className = lang;
      codeTag.innerHTML = codeHtml;
      $(this).attr('class', '').empty().html(codeTag);
      figure.attr('data-lang', lang.toUpperCase());
      hljs.highlightBlock(block);
    });
  })
</script>
<!-- Baidu Tongji -->

<script src="/js/script.js"></script>
  </body>
</html>